# test max compute throughput of A6000s.
program: benchmark.py
method: grid
name: a6000-compute-benchmark-v6-muon

metric:
  name: perf/steps_per_sec
  goal: maximize

parameters:
  seed:
    values: [42]

  model_name:
    values: ["gpt2-large"]
  
  sequence_length:
    values: [1024]
  batch_size:
    values: [8, 10, 12, 14]

  run_profile:
    values: ["bf16_native"]

  lr:
    values: [0.1]

  # --- NEW PARAMETER ---
  # We will test both AdamW (baseline) and Muon
  optimizer:
    values: ["muon"]

  # We will test both AdamW (baseline) and Muon
  optimizer:
    values: ["muon", "adamw"]
