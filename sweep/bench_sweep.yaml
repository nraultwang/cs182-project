# test max compute throughput of A6000s.
program: benchmark.py
method: grid
name: a6000-compute-benchmark-v6-muon

metric:
  name: perf/steps_per_sec
  goal: maximize

parameters:
  seed:
    values: [40, 41, 42, 43, 44, 45]

  model_name:
    values: ["gpt2"]
  
  sequence_length:
    values: [1024]
  batch_size:
    values: [16, 24, 32, 48, 56, 64]

  run_profile:
    values: ["bf16_native"]

  lr:
    values: [0.1]

  # We will test both AdamW (baseline) and Muon
  optimizer:
    values: ["muon"]
