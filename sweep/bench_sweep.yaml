# This sweep is designed to find the max compute throughput
# of your A6000s.
program: benchmark.py
method: grid
name: a6000-compute-benchmark-v4-muon

metric:
  name: perf/steps_per_sec
  goal: maximize

parameters:
  seed:
    values: [42]

  model_name:
    values: ["gpt2-medium"]
  
  sequence_length:
    values: [1024]

  run_profile:
    values: ["bf16_native", "fp32_accumulated"]

  # --- NEW PARAMETER ---
  # We will test both AdamW (baseline) and Muon
  optimizer:
    values: ["adamw", "muon"]


