# Main Hydra configuration file
# This file defines the structure and defaults for the entire config

defaults:
  - gpt_model: gpt-small        # Default model config
  - training_data: finewebmini  # Default dataset config
  - _self_                      # Include this file's content

# Global random seed (can be overridden by sweeps)
seed: 42

# Optimizer configuration
optimizer_params:
  name: adamw
  args:
    lr: 0.001
    weight_decay: 0.1
    # Optional parameters (can be overridden by sweeps)
    betas: null
    ns_steps: null
    polar_method: null
    polar_num_iters: null
    polar_safety: null
    polar_cushion: null
    adamw_betas: null

# Learning rate schedule
lr_schedule:
  name: constant-linear
  warm_up_fraction: 0.4

# Logging configuration
logging_params:
  val_tokens_processed: 16384  # 2^14
  log_step: 50
  val_step: 50
  save_ckpt_step: 500
  load_ckpt_step: 0
  keep_last: 2
  save_checkpoint: true  # Enable by default for long runs
  diag_log_step: 50
  svd_log_step: 50
  wandb:
    project: "cs182-polar-express"
    dir: "outputs/wandb"
    tags: []
